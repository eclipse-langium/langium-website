<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Langium showcase</title>
    <style>
        @font-face {
            font-family: 'codicon';
            src: url('../libs/monaco-editor-comp/assets/codicon.ttf') format('truetype');
        }
        html, body, #monaco-editor-root {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
    <div id="monaco-editor-root"></div>

    <script type="module">
        import { getMonacoCss, MonacoEditorLanguageClientWrapper } from '../libs/monaco-editor-comp/index.js';
        import { buildWorkerDefinition } from "../libs/monaco-editor-workers/index.js";

        buildWorkerDefinition('../libs/monaco-editor-workers/workers', import.meta.url, false);
        const style = document.createElement("style");
        style.innerHTML = getMonacoCss();
        document.head.appendChild(style);

        const client = new MonacoEditorLanguageClientWrapper(42);
        const editorConfig = client.getEditorConfig();
        editorConfig.setMainLanguageId('statemachine');
        editorConfig.setMainCode(`
statemachine TrafficLight

events
    switchCapacity
    next

initialState PowerOff

state PowerOff
    switchCapacity => RedLight
end

state RedLight
    switchCapacity => PowerOff
    next => GreenLight
end

state YellowLight
    switchCapacity => PowerOff
    next => RedLight
end

state GreenLight
    switchCapacity => PowerOff
    next => YellowLight
end
`);
        editorConfig.theme = 'vs-dark';

        editorConfig.useLanguageClient = true;
        editorConfig.lcConfigOptions = {
            useWebSocket: false,
            wsSecured: false,
            wsHost: "localhost",
            wsPort: "3000",
            wsPath: "sampleServer",
            workerURL: "../libs/worker/serverWorker-es.js"
        };

        client.startEditor(document.getElementById("monaco-editor-root"));

        window.addEventListener("resize", () => client.updateLayout());
    </script>
</body>

</html>
